CREATE OR REPLACE VIEW T1
AS
SELECT  

SA.SA_MMCODE AS "MMCODE", 
				SALES 테이블의 회원 코드 => MMCODE
MM.MM_NAME AS "MMNAME",
				MEMBER 테이블의 회원 이름 => MMNAME
COUNT(SA.SA_DATE) AS "PCOUNT"
				SALE테이블의 판매 날짜 카운트 => PCOUNT
FROM  
MM INNER JOIN SA	
				MEMBER 테이블 SALE 테이블 이너조인
ON MM.MM_CODE = SA.SA_MMCODE
				MEMBER테이블의 회원 코드 = SALE테이블의 회원 코드
GROUP BY SA.SA_MMCODE, MM.MM_NAME;
				SALE 테이블의 회원코드, MEMBER 테이블의 회원이름 그룹핑

CREATE OR REPLACE VIEW T2
AS
SELECT  
SD.SD_SAMMCODE AS "MMCODE",
				SALEDATAIL 테이블의 회원코드
AVG(GO.GO_PRICE * SD.SD_QTY) AS "AVGPAY",
				GOODS 테이블의 가격 
SUM(GO.GO_PRICE * SD.SD_QTY) AS "TOTPAY"
FROM 
GO INNER JOIN SD
ON GO.GO_CODE = SD.SD_GOCODE
GROUP BY SD.SD_SAMMCODE;
      
-- FINAL
SELECT T1.MMCODE, T1.MMNAME, T1.PCOUNT, T2.AVGPAY, T2.TOTPAY

FROM T1 INNER JOIN T2
ON T1.MMCODE = T2.MMCODE;


<OFC, CTS>
CREATE OR REPLACE VIEW OF1
AS
SELECT 
OFC.OFC_STC_CODE AS "OFC_STC_CODE",
OFC.OFC_TEACHER AS "OFC_TEACHER",
OFC.OFC_SALE AS "OFC_SALE"
OFC.OFC_CODE AS "OFC_CODE",
OFC.OFC_TITLE AS "OFC_TITLE",
CTS.CTS_NAME AS "CTS_NAME"
FROM
OFC INNER JOIN CTS
ON CTS.CTS_CODE = OFC.OFC_CTS_CODE
GROUP BY OFC_CTS_CODE;


CREATE OR REPLACE VIEW OF2
AS
SELECT 
F.F_ORINAME AS "F_ORINAME",
CTS.CTS_NAME AS "CTS_NAME"
CTS.F_PCODE AS "F_PCODE"
FROM
F INNER JOIN CTS
ON F_CTS_CODE = CTS_CODE;

SELECT OF1.OFC_TITLE, OF2.CTS_NAME, OF2.F_ORINAME
FROM OF1 INNER JOIN OF2
ON OF1.OFC_CODE = OF2.F_PCODE
GROUP BY OF1.OFC_CODE;

OF.